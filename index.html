<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Areas</title>
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    .areas {
      /*
      --areas-overlay-color: red;
      --areas-overlay-outline-offset: 10px;
      --areas-overlay-outline: dotted 5px blue;
      --areas-overlay-split-color: red;
      --areas-overlay-split-outline-offset: 10px;
      --areas-overlay-split-outline: dotted 5px blue;
      --areas-overlay-delete-color: red;
      --areas-overlay-delete-outline-offset: 10px;
      --areas-overlay-delete-outline: dotted 5px blue;
      --areas-overlay-swap-color: green;
      --areas-overlay-swap-outline-offset: 10px;
      --areas-overlay-swap-outline: dashed 5px yellow;
      --areas-overlay-swapover-color: red;
      --areas-overlay-swapover-outline-offset: 10px;
      --areas-overlay-swapover-outline: dotted 5px blue;
      --areas-overlay-color: rgba(0, 0, 100, 0.4);
      --areas-split-line-color: yellow;
      --areas-background-color: blue;
      --areas-separator-color: red;
      --areas-delete-cursor: progress;
      --areas-vertical-resize-cursor: wait;
      --areas-horizontal-resize-cursor: grabbing;
      --areas-vertical-split-cursor: not-allowed;
      --areas-horizontal-split-cursor: zoom-in;
      --areas-drag-cursor: help;
      --areas-dragging-cursor: context-menu;
      --areas-delete-cursor: cell;
      */
    }
  </style>
</head>

<body>
  <div id="app"></div>
  <script type="module">
    import Vue from '../../node_modules/vue/dist/vue.esm.browser.js';
    import Areas from "./dist/areas.esm.js";

    let areas = null;

    const headerComponent = {
      data() {
        return {
          optionsShown: false,
          selectedOption: null,
        }
      },
      computed: {
        mainButtonContent() {
          return this.optionsShown ? "Hide options" : "Show options";
        }
      },
      watch: {
        optionsShown() {
          if (!this.optionsShown && this.selectedOption !== null) {
            this.selectedOption = null
          }
        },
        selectedOption() {
          areas.setMode(this.selectedOption);
        }
      },
      methods: {

      },
      template: `
        <div style="margin:10px;">
          <button type="button" @click="optionsShown = !optionsShown">{{ mainButtonContent }}</button>
          <template v-if="optionsShown">
            <input type="radio" id="radio0" :value="null" v-model="selectedOption">
            <label for="radio0">No option</label>
            <input type="radio" id="radio1" value="split-vertical" v-model="selectedOption">
            <label for="radio1">Vertical split</label>
            <input type="radio" id="radio2" value="split-horizontal" v-model="selectedOption">
            <label for="radio2">Horizontal split</label>
            <input type="radio" id="radio3" value="swap" v-model="selectedOption">
            <label for="radio3">Swap</label>
            <input type="radio" id="radio4" value="delete" v-model="selectedOption">
            <label for="radio4">Delete</label>
          </template>
        </div>`
    }

    const vm = new Vue({
      render: function (h) {
        return h("div", { style: "width: 80%; margin: auto; height: 80%;" }, [
          h(headerComponent),
          h(Areas,
            {
              ref: "areas",
              props: {
                cfg: {
                  // areaMinRatio: 10,
                  // separatorDetectionMargin: 20,
                  // separatorThickness: 10,
                  components: [
                    {
                      inject: ["$area"],
                      props: { text: { type: String, default: "no text provided" } },
                      created() {
                        this.$area.onChange(this.handler);
                      },
                      mounted() {
                        this.$emit("mounted");
                      },
                      methods: {
                        handler(id, old) {
                          console.log(`change area from ${old} to ${id}`);
                          console.log(this.$area.domElement);
                          console.log(this.$area.id);
                          console.log(this.$area.contentComponent);
                          console.log(this.$area.component);
                          console.log(this.$area.areas);
                        },
                        stop() {
                          this.$area.offChange(this.handler);
                        }
                      },
                      template: `<div>
                          {{text}}
                          <button type="button" @click="stop">Click to stop listening to area change</button>
                        </div>`
                    },
                    { props: { text: { type: String, default: "no text provided" } }, render(h) { return h("div", this.text) } },
                    { render(h) { return h("div", "Hey !") } },
                  ],
                  layout: {
                    direction: "row",
                    ratios: [20, 80],
                    children: [
                      {
                        name: "comp1", // Can be used to get this specific component
                        componentIndex: 0,
                        cfg: {
                          on: {
                            mounted() {
                              console.log("Comp 1 mounted !");
                            }
                          },
                          props: {
                            text: "nothing"
                          }
                        }
                      },
                      {
                        direction: "column",
                        ratios: [40, 50, 10],
                        children: [
                          {
                            componentIndex: 1,
                            cfg: {
                              props: {
                                text: "Hey :D"
                              }
                            }
                          },
                          {
                            componentIndex: 2
                          },
                          {
                            componentIndex: null // if null, render a customizable default component
                          },
                        ]
                      }
                    ]
                  }
                }
              }
            }
          )])
      },
    }).$mount('#app');

    // areas = vm.$refs.areas;
    // areas.getAreaContentByName("comp1").cfg.props.text = "Youhou ! =D"; // This is reactive !

  </script>
</body>

</html>